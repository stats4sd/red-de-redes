setwd("C:/Users/CiaraMcHugh/Dropbox (SSD)/Work/RMS/Andes/Bolivia/Red de Redes/Platform/R/")
library(tidyverse)
install.packages("tidyverse")
library(tidyverse)
library(RMySQL)
renv::install("tidyerse")
renv::install("tidyerse")
renv::install("tidyverse")
library(tidyverse)
library(dotenv)
library(RMySQL)
library(tidyverse)
dotenv::load_dot_env("../../.env")
con <- dbConnect(RMySQL::MySQL(),
dbname = Sys.getenv("DB_DATABASE"),
host = Sys.getenv("DB_HOST"),
port = as.integer(Sys.getenv("DB_PORT")),
user = Sys.getenv("DB_USERNAME"),
password = Sys.getenv("DB_PASSWORD")
)
daily_met_data_table <- tbl(con, "daily_met_data")
selected_station <- 1
selected_year <- "2016"
selected_variable <- "max_temperatura_interna"
data <- daily_met_data_table %>%
mutate(day=sql(DAY(fecha)),
month=sql(MONTH(fecha)),
year=sql(YEAR(fecha))) %>%
filter(station_id==selected_station & year==selected_year) %>%
select(day, month, selected_variable) %>%
collect()
senamhi_daily <- data %>%
arrange(month) %>%
complete(month=1:12) %>%
pivot_wider(names_from = "month", values_from = 3) %>%
arrange(day) %>%
complete(day=1:31) %>%
filter(!is.na(day)) %>%
rename("DÍA"=day, ENE=`1`, FEB=`2`, MAR=`3`, ABR=`4`, MAY=`5`, JUN=`6`,
JUL=`7`, AGO=`8`, SEP=`9`, OCT=`10`, NOV=`11`, DIC=`12`)
View(senamhi_daily)
dotenv::load_dot_env("../../.env")
dotenv::load_dot_env("../../.env")
library(dotenv)
library(RMySQL)
library(tidyverse)
dotenv::load_dot_env("../../.env")
con <- dbConnect(RMySQL::MySQL(),
dbname = Sys.getenv("DB_DATABASE"),
host = Sys.getenv("DB_HOST"),
port = as.integer(Sys.getenv("DB_PORT")),
user = Sys.getenv("DB_USERNAME"),
password = Sys.getenv("DB_PASSWORD")
)
daily_met_data_table <- tbl(con, "daily_met_data")
selected_station <- 1
selected_start_year <- "2016"
selected_end_year <- "2020"
selected_variable <- "max_temperatura_interna"
data <- daily_met_data_table %>%
mutate(month=sql(MONTH(fecha)),
year=sql(YEAR(fecha))) %>%
filter(station_id==selected_station & year>=selected_start_year & year<=selected_end_year) %>%
select(station_id, year, selected_variable) %>%
collect()
View(data)
data$station_id <- as.factor(data$station_id)
data$variable_na <- is.na(data$selected_variable)
data <- daily_met_data_table %>%
mutate(month=sql(MONTH(fecha)),
year=sql(YEAR(fecha))) %>%
filter(station_id==selected_station & year>=selected_start_year & year<=selected_end_year) %>%
select(station_id, year, selected_variable) %>%
collect()
data$station_id <- as.factor(data$station_id)
colnames(data)[3] <- "variable"
data$variable_na <- is.na(data$variable)
#png(filename="inventario.png", width = 1000, height = 500, units = "px")
data %>%
ggplot(aes(x = fecha, y = station_id, fill = variable_na)) +
geom_raster(alpha = 0.9) +
scale_fill_manual(name = "", values = c("#556FBF", "darkgray"), labels = c("Presente", "Faltante")) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
labs(x = "Año", y = "Estaciones", title = "Temperatura Minima TN 2006 - 2018") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_text(angle=0)) +
theme(legend.position = "bottom")
data <- daily_met_data_table %>%
mutate(month=sql(MONTH(fecha)),
year=sql(YEAR(fecha))) %>%
filter(station_id==selected_station & year>=selected_start_year & year<=selected_end_year) %>%
select(station_id, fecha, selected_variable) %>%
collect()
data$station_id <- as.factor(data$station_id)
colnames(data)[3] <- "variable"
data$variable_na <- is.na(data$variable)
#png(filename="inventario.png", width = 1000, height = 500, units = "px")
data %>%
ggplot(aes(x = fecha, y = station_id, fill = variable_na)) +
geom_raster(alpha = 0.9) +
scale_fill_manual(name = "", values = c("#556FBF", "darkgray"), labels = c("Presente", "Faltante")) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
labs(x = "Año", y = "Estaciones", title = "Temperatura Minima TN 2006 - 2018") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_text(angle=0)) +
theme(legend.position = "bottom")
data$fecha <- as.Date(data$fecha)
colnames(data)[3] <- "variable"
data$variable_na <- is.na(data$variable)
#png(filename="inventario.png", width = 1000, height = 500, units = "px")
data %>%
ggplot(aes(x = fecha, y = station_id, fill = variable_na)) +
geom_raster(alpha = 0.9) +
scale_fill_manual(name = "", values = c("#556FBF", "darkgray"), labels = c("Presente", "Faltante")) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
labs(x = "Año", y = "Estaciones", title = "Temperatura Minima TN 2006 - 2018") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_text(angle=0)) +
theme(legend.position = "bottom")
#png(filename="inventario.png", width = 1000, height = 500, units = "px")
data %>%
ggplot(aes(x = fecha, y = station_id, fill = variable_na)) +
geom_raster(alpha = 0.9) +
scale_fill_manual(name = "", values = c("#556FBF", "darkgray"), labels = c("Presente", "Faltante")) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
labs(x = "Año", y = "Estaciones", title = selected_variable) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_text(angle=0)) +
theme(legend.position = "bottom")
stations_table <- tbl(con, "stations")
stations_table <- tbl(con, "stations") %>%
select(1,3) %>%
collect()
View(stations_table)
dotenv::load_dot_env("../../.env")
con <- dbConnect(RMySQL::MySQL(),
dbname = Sys.getenv("DB_DATABASE"),
host = Sys.getenv("DB_HOST"),
port = as.integer(Sys.getenv("DB_PORT")),
user = Sys.getenv("DB_USERNAME"),
password = Sys.getenv("DB_PASSWORD")
)
stations_table <- tbl(con, "stations") %>%
select(1,3) %>%
collect()
daily_met_data_table <- tbl(con, "daily_met_data")
selected_station <- 1
selected_start_year <- "2016"
selected_end_year <- "2020"
selected_variable1 <- "max_temperatura_interna"
selected_variable2 <- "avg_temperatura_interna"
selected_variable3 <- "min_temperatura_interna"
data <- daily_met_data_table %>%
mutate(month=sql(MONTH(fecha)),
year=sql(YEAR(fecha))) %>%
filter(station_id==selected_station & year>=selected_start_year & year<=selected_end_year) %>%
select(station_id, fecha, selected_variable1, selected_variable2, selected_variable3) %>%
collect()
data$station_id <- as.factor(data$station_id)
data$fecha <- as.Date(data$fecha)
View(data)
daily_met_data_table <- tbl(con, "daily_met_data")
selected_station <- 1
selected_start_year <- "2016"
selected_end_year <- "2020"
selected_variable1 <- "max_temperatura_interna"
selected_variable2 <- "avg_temperatura_interna"
selected_variable3 <- "min_temperatura_interna"
data <- daily_met_data_table %>%
mutate(month=sql(MONTH(fecha)),
year=sql(YEAR(fecha))) %>%
filter(station_id==selected_station & year>=selected_start_year & year<=selected_end_year) %>%
select(station_id, fecha, selected_variable1, selected_variable2, selected_variable3) %>%
collect()
data$station_id <- as.factor(data$station_id)
data$fecha <- as.Date(data$fecha)
colnames(data)[3] <- "variable1"
colnames(data)[4] <- "variable2"
colnames(data)[5] <- "variable3"
data %>%
ggplot(aes(x = fecha)) +
geom_line(aes(y = variable1) , color ="#FA8275", size = 0.3) +
geom_line(aes(y = variable2) , color ="#FA8275", size = 0.3) +
geom_line(aes(y = variable3) , color ="#FA8275", size = 0.3) +
annotate("text", x = as.Date (" 2016-01-01"), y = 0, label = "Ground", color ="#00C32F") +
labs(x ="A?o", y = "TN (C)", title = "Temperatura Minima(Serrano)") +
theme_minimal() +
theme(legend.position = "bottom") +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5), axis.text.x = element_text(angle = 0)) +
theme(legend.position = "bottom")
data %>%
ggplot(aes(x = fecha)) +
geom_line(aes(y = variable1) , color ="#FA8275", size = 0.3) +
geom_line(aes(y = variable2) , color ="#FA8275", size = 0.3) +
geom_line(aes(y = variable3) , color ="#FA8275", size = 0.3) +
annotate("text", x = as.Date (" 2016-01-01"), y = 0, label = "Ground", color ="#00C32F") +
labs(x ="Año", y = "TN (C)", title = "Temperatura Minima(Serrano)") +
theme_minimal() +
theme(legend.position = "bottom") +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5), axis.text.x = element_text(angle = 0)) +
theme(legend.position = "bottom")
data %>%
ggplot(aes(x = fecha)) +
geom_line(aes(y = variable1) , color ="#FA8275", size = 0.3) +
geom_line(aes(y = variable2) , color ="#69A4FF", size = 0.3) +
geom_line(aes(y = variable3) , color ="#00C32F", size = 0.3) +
annotate("text", x = 0, y = 0, label = variable1, color ="#FA8275") +
annotate("text", x = 0, y = 0, label = variable2, color ="#69A4FF") +
annotate("text", x = 0, y = 0, label = variable3, color ="#00C32F") +
labs(x ="Año", y = "TN (C)", title = "Temperatura Minima(Serrano)") +
theme_minimal() +
theme(legend.position = "bottom") +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5), axis.text.x = element_text(angle = 0)) +
theme(legend.position = "bottom")
data %>%
ggplot(aes(x = fecha)) +
geom_line(aes(y = variable1) , color ="#FA8275", size = 0.3) +
geom_line(aes(y = variable2) , color ="#69A4FF", size = 0.3) +
geom_line(aes(y = variable3) , color ="#00C32F", size = 0.3) +
annotate("text", x = 0, y = 0, label = selected_variable_1, color ="#FA8275") +
annotate("text", x = 0, y = 0, label = selected_variable_2, color ="#69A4FF") +
annotate("text", x = 0, y = 0, label = selected_variable_3, color ="#00C32F") +
labs(x ="Año", y = "TN (C)", title = "Temperatura Minima(Serrano)") +
theme_minimal() +
theme(legend.position = "bottom") +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5), axis.text.x = element_text(angle = 0)) +
theme(legend.position = "bottom")
stations_table <- tbl(con, "stations") %>%
select(1,3) %>%
collect()
daily_met_data_table <- tbl(con, "daily_met_data")
selected_station <- 1
selected_start_year <- "2016"
selected_end_year <- "2020"
selected_variable1 <- "max_temperatura_interna"
selected_variable2 <- "avg_temperatura_interna"
selected_variable3 <- "min_temperatura_interna"
data <- daily_met_data_table %>%
mutate(month=sql(MONTH(fecha)),
year=sql(YEAR(fecha))) %>%
filter(station_id==selected_station & year>=selected_start_year & year<=selected_end_year) %>%
select(station_id, fecha, selected_variable1, selected_variable2, selected_variable3) %>%
collect()
data$station_id <- as.factor(data$station_id)
data$fecha <- as.Date(data$fecha)
colnames(data)[3] <- "variable1"
colnames(data)[4] <- "variable2"
colnames(data)[5] <- "variable3"
data %>%
ggplot(aes(x = fecha)) +
geom_line(aes(y = variable1) , color ="#FA8275", size = 0.3) +
geom_line(aes(y = variable2) , color ="#69A4FF", size = 0.3) +
geom_line(aes(y = variable3) , color ="#00C32F", size = 0.3) +
annotate("text", x = 0, y = 0, label = selected_variable_1, color ="#FA8275") +
annotate("text", x = 0, y = 0, label = selected_variable_2, color ="#69A4FF") +
annotate("text", x = 0, y = 0, label = selected_variable_3, color ="#00C32F") +
labs(x ="Año", y = "TN (C)", title = "Temperatura Minima(Serrano)") +
theme_minimal() +
theme(legend.position = "bottom") +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5), axis.text.x = element_text(angle = 0)) +
theme(legend.position = "bottom")
data %>%
ggplot(aes(x = fecha)) +
geom_line(aes(y = variable1) , color ="#FA8275", size = 0.3) +
geom_line(aes(y = variable2) , color ="#69A4FF", size = 0.3) +
geom_line(aes(y = variable3) , color ="#00C32F", size = 0.3) +
#  annotate("text", x = 0, y = 0, label = selected_variable_1, color ="#FA8275") +
#  annotate("text", x = 0, y = 0, label = selected_variable_2, color ="#69A4FF") +
#  annotate("text", x = 0, y = 0, label = selected_variable_3, color ="#00C32F") +
labs(x ="Año", y = "TN (C)", title = "Temperatura Minima(Serrano)") +
theme_minimal() +
theme(legend.position = "bottom") +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5), axis.text.x = element_text(angle = 0)) +
theme(legend.position = "bottom")
data %>%
ggplot(aes(x = fecha)) +
geom_line(aes(y = variable1) , color ="#FA8275", size = 0.3) +
geom_line(aes(y = variable2) , color ="#69A4FF", size = 0.3) +
geom_line(aes(y = variable3) , color ="#00C32F", size = 0.3) +
#  annotate("text", x = 0, y = 0, label = selected_variable_1, color ="#FA8275") +
#  annotate("text", x = 0, y = 0, label = selected_variable_2, color ="#69A4FF") +
#  annotate("text", x = 0, y = 0, label = selected_variable_3, color ="#00C32F") +
labs(x ="Año", y = "TN (C)", title = "Temperatura Minima(Serrano)") +
theme_minimal() +
#theme(legend.position = "bottom") +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5), axis.text.x = element_text(angle = 0)) +
theme(legend.position = "bottom")
install.packages("evapotranspiration")
library(Evapotranspiration)
library(Evapotranspiration)
